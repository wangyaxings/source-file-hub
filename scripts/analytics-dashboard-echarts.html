<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Analytics Dashboard</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/echarts/5.4.3/echarts.min.js"></script>
    <!-- Lucide Icons -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/lucide/0.263.0/umd/lucide.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --background: #ffffff;
            --foreground: #0f172a;
            --card: #ffffff;
            --card-foreground: #0f172a;
            --popover: #ffffff;
            --popover-foreground: #0f172a;
            --primary: #0f172a;
            --primary-foreground: #f8fafc;
            --secondary: #f1f5f9;
            --secondary-foreground: #0f172a;
            --muted: #f1f5f9;
            --muted-foreground: #64748b;
            --accent: #f1f5f9;
            --accent-foreground: #0f172a;
            --destructive: #ef4444;
            --destructive-foreground: #f8fafc;
            --border: #e2e8f0;
            --input: #e2e8f0;
            --ring: #94a3b8;
            --chart-1: #3b82f6;
            --chart-2: #10b981;
            --chart-3: #f59e0b;
            --chart-4: #8b5cf6;
            --chart-5: #06b6d4;
            --success: #22c55e;
            --warning: #f59e0b;
            --error: #ef4444;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            background-color: var(--background);
            color: var(--foreground);
            line-height: 1.5;
        }

        .dashboard {
            min-height: 100vh;
            padding: 24px;
            background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%);
        }

        .header {
            display: flex;
            flex-direction: column;
            gap: 16px;
            margin-bottom: 32px;
        }

        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            flex-wrap: wrap;
            gap: 16px;
        }

        .header-title {
            flex: 1;
        }

        .header-title h1 {
            font-size: 2rem;
            font-weight: 700;
            color: var(--foreground);
            margin-bottom: 8px;
        }

        .header-title p {
            color: var(--muted-foreground);
            font-size: 0.95rem;
        }

        .header-controls {
            display: flex;
            gap: 12px;
            flex-wrap: wrap;
            align-items: center;
        }

        .select-wrapper {
            position: relative;
            min-width: 140px;
        }

        .select {
            width: 100%;
            padding: 8px 12px;
            border: 1px solid var(--border);
            border-radius: 8px;
            background: var(--card);
            color: var(--foreground);
            font-size: 0.875rem;
            appearance: none;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .select:hover {
            border-color: var(--primary);
        }

        .select:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 2px rgba(15, 23, 42, 0.1);
        }

        .export-btn {
            padding: 8px 16px;
            border: 1px solid var(--border);
            border-radius: 8px;
            background: var(--card);
            color: var(--foreground);
            font-size: 0.875rem;
            cursor: pointer;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .export-btn:hover {
            background: var(--muted);
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
            gap: 20px;
            margin-bottom: 32px;
        }

        .stat-card {
            background: var(--card);
            border: 1px solid var(--border);
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 2px 8px rgba(15, 23, 42, 0.08);
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .stat-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(15, 23, 42, 0.15);
        }

        .stat-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(90deg, var(--chart-1), var(--chart-2));
        }

        .stat-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 12px;
        }

        .stat-title {
            font-size: 0.875rem;
            color: var(--muted-foreground);
            font-weight: 500;
        }

        .stat-icon {
            width: 20px;
            height: 20px;
            color: var(--muted-foreground);
        }

        .stat-value {
            font-size: 2rem;
            font-weight: 700;
            color: var(--foreground);
            margin-bottom: 8px;
        }

        .stat-footer {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .stat-description {
            font-size: 0.75rem;
            color: var(--muted-foreground);
        }

        .stat-trend {
            font-size: 0.75rem;
            padding: 4px 8px;
            border-radius: 6px;
            font-weight: 500;
        }

        .trend-positive {
            background: rgba(34, 197, 94, 0.1);
            color: var(--success);
        }

        .trend-neutral {
            background: rgba(251, 191, 36, 0.1);
            color: var(--warning);
        }

        .charts-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 24px;
            margin-bottom: 32px;
        }

        .chart-card {
            background: var(--card);
            border: 1px solid var(--border);
            border-radius: 12px;
            padding: 24px;
            box-shadow: 0 2px 8px rgba(15, 23, 42, 0.08);
        }

        .chart-header {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 8px;
        }

        .chart-title {
            font-size: 1.25rem;
            font-weight: 600;
            color: var(--foreground);
        }

        .chart-description {
            color: var(--muted-foreground);
            font-size: 0.875rem;
            margin-bottom: 24px;
        }

        .chart-container {
            width: 100%;
            height: 300px;
        }

        .charts-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 24px;
            margin-bottom: 24px;
        }

        .hourly-chart {
            grid-column: 1 / -1;
        }

        .hourly-chart .chart-container {
            height: 250px;
        }

        @media (max-width: 1024px) {
            .charts-row {
                grid-template-columns: 1fr;
            }

            .header-content {
                flex-direction: column;
                align-items: stretch;
            }

            .header-controls {
                justify-content: flex-start;
            }
        }

        @media (max-width: 768px) {
            .dashboard {
                padding: 16px;
            }

            .stats-grid {
                grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
                gap: 16px;
            }

            .chart-card {
                padding: 16px;
            }

            .stat-card {
                padding: 16px;
            }
        }

        /* Icon styles */
        .icon {
            display: inline-block;
            width: 16px;
            height: 16px;
            stroke: currentColor;
            stroke-width: 2;
            stroke-linecap: round;
            stroke-linejoin: round;
            fill: none;
        }

        .icon-sm {
            width: 14px;
            height: 14px;
        }

        .icon-lg {
            width: 20px;
            height: 20px;
        }

        @keyframes spin {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        .loading {
            display: flex;
            align-items: center;
            justify-content: center;
            height: 200px;
            color: var(--muted-foreground);
        }
    </style>
</head>
<body>
    <div class="dashboard">
        <!-- Header -->
        <div class="header">
            <div class="header-content">
                <div class="header-title">
                    <h1><i data-lucide="bar-chart-3" class="icon icon-lg" style="margin-right: 12px; vertical-align: text-bottom;"></i>Analytics Dashboard</h1>
                    <p>Comprehensive API usage analytics and insights</p>
                </div>

                <div class="header-controls">
                    <div class="select-wrapper">
                        <select class="select" id="timeRange">
                            <option value="24h">Last 24 Hours</option>
                            <option value="7d">Last 7 Days</option>
                            <option value="30d">Last 30 Days</option>
                        </select>
                    </div>

                    <div class="select-wrapper">
                        <select class="select" id="apiKey">
                            <option value="all">All API Keys</option>
                            <option value="demo-a">Demo Key A</option>
                            <option value="demo-b">Demo Key B</option>
                            <option value="demo-c">Demo Key C</option>
                        </select>
                    </div>

                    <div class="select-wrapper">
                        <select class="select" id="user">
                            <option value="all">All Users</option>
                            <option value="admin">Admin</option>
                            <option value="demo">Demo User</option>
                        </select>
                    </div>

                    <button class="export-btn" onclick="exportData()">
                        <i data-lucide="download" class="icon icon-sm"></i>
                        Export
                    </button>
                </div>
            </div>
        </div>

        <!-- Stats Cards -->
        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-header">
                    <span class="stat-title">Total Requests</span>
                    <i data-lucide="trending-up" class="icon stat-icon"></i>
                </div>
                <div class="stat-value">3</div>
                <div class="stat-footer">
                    <span class="stat-description">API requests in selected period</span>
                    <span class="stat-trend trend-neutral">+0%</span>
                </div>
            </div>

            <div class="stat-card">
                <div class="stat-header">
                    <span class="stat-title">Active Users</span>
                    <i data-lucide="users" class="icon stat-icon"></i>
                </div>
                <div class="stat-value">2</div>
                <div class="stat-footer">
                    <span class="stat-description">Unique users making requests</span>
                    <span class="stat-trend trend-neutral">+0%</span>
                </div>
            </div>

            <div class="stat-card">
                <div class="stat-header">
                    <span class="stat-title">Success Rate</span>
                    <i data-lucide="check-circle" class="icon stat-icon"></i>
                </div>
                <div class="stat-value">100.0%</div>
                <div class="stat-footer">
                    <span class="stat-description">Successful API responses</span>
                    <span class="stat-trend trend-positive">Perfect</span>
                </div>
            </div>

            <div class="stat-card">
                <div class="stat-header">
                    <span class="stat-title">Error Rate</span>
                    <i data-lucide="x-circle" class="icon stat-icon"></i>
                </div>
                <div class="stat-value">0.0%</div>
                <div class="stat-footer">
                    <span class="stat-description">Failed API responses</span>
                    <span class="stat-trend trend-positive">Excellent</span>
                </div>
            </div>

            <div class="stat-card">
                <div class="stat-header">
                    <span class="stat-title">Avg Response</span>
                    <i data-lucide="clock" class="icon stat-icon"></i>
                </div>
                <div class="stat-value">13ms</div>
                <div class="stat-footer">
                    <span class="stat-description">Average response time</span>
                    <span class="stat-trend trend-positive">-5ms</span>
                </div>
            </div>

            <div class="stat-card">
                <div class="stat-header">
                    <span class="stat-title">API Keys</span>
                    <i data-lucide="key" class="icon stat-icon"></i>
                </div>
                <div class="stat-value">3</div>
                <div class="stat-footer">
                    <span class="stat-description">Active API keys</span>
                    <span class="stat-trend trend-neutral">+0</span>
                </div>
            </div>
        </div>

        <!-- Main Trend Chart -->
        <div class="charts-grid">
            <div class="chart-card">
                <div class="chart-header">
                    <i data-lucide="activity" class="icon"></i>
                    <span class="chart-title">API Usage Trends</span>
                </div>
                <div class="chart-description">Request volume, success rate, and response times over time</div>
                <div class="chart-container" id="trendChart"></div>
            </div>
        </div>

        <!-- Secondary Charts Row -->
        <div class="charts-row">
            <div class="chart-card">
                <div class="chart-header">
                    <i data-lucide="key" class="icon"></i>
                    <span class="chart-title">API Key Usage Distribution</span>
                </div>
                <div class="chart-description">Request distribution across different API keys</div>
                <div class="chart-container" id="apiKeyChart"></div>
            </div>

            <div class="chart-card">
                <div class="chart-header">
                    <i data-lucide="pie-chart" class="icon"></i>
                    <span class="chart-title">Operation Types Distribution</span>
                </div>
                <div class="chart-description">Breakdown of API operation types</div>
                <div class="chart-container" id="operationChart"></div>
            </div>
        </div>

        <!-- Hourly Distribution -->
        <div class="chart-card hourly-chart">
            <div class="chart-header">
                <i data-lucide="clock" class="icon"></i>
                <span class="chart-title">Hourly Request Distribution</span>
            </div>
            <div class="chart-description">Request volume pattern throughout the day</div>
            <div class="chart-container" id="hourlyChart"></div>
        </div>
    </div>

    <script>
        // 主题配置
        const theme = {
            color: ['#3b82f6', '#10b981', '#f59e0b', '#8b5cf6', '#06b6d4', '#ef4444'],
            backgroundColor: 'transparent',
            textStyle: {
                fontFamily: '-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif',
                color: '#0f172a'
            },
            title: {
                textStyle: {
                    color: '#0f172a',
                    fontWeight: 600
                }
            },
            legend: {
                textStyle: {
                    color: '#64748b',
                    fontSize: 12
                }
            },
            grid: {
                borderColor: '#e2e8f0'
            }
        };

        // 数据
        const hourlyData = [
            { time: '00:00', requests: 0, success: 0, errors: 0, responseTime: 0 },
            { time: '02:00', requests: 0, success: 0, errors: 0, responseTime: 0 },
            { time: '04:00', requests: 0, success: 0, errors: 0, responseTime: 0 },
            { time: '06:00', requests: 0, success: 0, errors: 0, responseTime: 0 },
            { time: '08:00', requests: 0, success: 0, errors: 0, responseTime: 0 },
            { time: '10:00', requests: 0, success: 0, errors: 0, responseTime: 0 },
            { time: '12:00', requests: 0, success: 0, errors: 0, responseTime: 0 },
            { time: '14:00', requests: 3, success: 3, errors: 0, responseTime: 13 },
            { time: '16:00', requests: 0, success: 0, errors: 0, responseTime: 0 },
            { time: '18:00', requests: 0, success: 0, errors: 0, responseTime: 0 },
            { time: '20:00', requests: 0, success: 0, errors: 0, responseTime: 0 },
            { time: '22:00', requests: 0, success: 0, errors: 0, responseTime: 0 }
        ];

        // 初始化图表
        function initCharts() {
            // 1. API Usage Trends (多轴线图)
            const trendChart = echarts.init(document.getElementById('trendChart'), theme);
            const trendOption = {
                tooltip: {
                    trigger: 'axis',
                    axisPointer: {
                        type: 'cross'
                    },
                    backgroundColor: 'rgba(255, 255, 255, 0.95)',
                    borderColor: '#e2e8f0',
                    textStyle: {
                        color: '#0f172a',
                        fontSize: 12
                    }
                },
                legend: {
                    data: ['Total Requests', 'Successful', 'Errors', 'Avg Response Time (ms)'],
                    bottom: 0,
                    textStyle: {
                        fontSize: 12
                    }
                },
                grid: {
                    left: '3%',
                    right: '4%',
                    bottom: '15%',
                    containLabel: true
                },
                xAxis: {
                    type: 'category',
                    boundaryGap: false,
                    data: hourlyData.map(item => item.time),
                    axisLine: {
                        lineStyle: {
                            color: '#e2e8f0'
                        }
                    },
                    axisLabel: {
                        color: '#64748b',
                        fontSize: 12
                    }
                },
                yAxis: [
                    {
                        type: 'value',
                        name: 'Requests',
                        position: 'left',
                        axisLine: {
                            lineStyle: {
                                color: '#e2e8f0'
                            }
                        },
                        axisLabel: {
                            color: '#64748b',
                            fontSize: 12
                        },
                        splitLine: {
                            lineStyle: {
                                color: '#f1f5f9',
                                type: 'dashed'
                            }
                        }
                    },
                    {
                        type: 'value',
                        name: 'Response Time (ms)',
                        position: 'right',
                        axisLine: {
                            lineStyle: {
                                color: '#e2e8f0'
                            }
                        },
                        axisLabel: {
                            color: '#64748b',
                            fontSize: 12
                        }
                    }
                ],
                series: [
                    {
                        name: 'Total Requests',
                        type: 'line',
                        yAxisIndex: 0,
                        data: hourlyData.map(item => item.requests),
                        smooth: true,
                        symbol: 'circle',
                        symbolSize: 6,
                        lineStyle: {
                            width: 3
                        },
                        areaStyle: {
                            opacity: 0.1
                        }
                    },
                    {
                        name: 'Successful',
                        type: 'line',
                        yAxisIndex: 0,
                        data: hourlyData.map(item => item.success),
                        smooth: true,
                        symbol: 'circle',
                        symbolSize: 6,
                        lineStyle: {
                            width: 3
                        }
                    },
                    {
                        name: 'Errors',
                        type: 'line',
                        yAxisIndex: 0,
                        data: hourlyData.map(item => item.errors),
                        smooth: true,
                        symbol: 'circle',
                        symbolSize: 6,
                        lineStyle: {
                            width: 3
                        }
                    },
                    {
                        name: 'Avg Response Time (ms)',
                        type: 'line',
                        yAxisIndex: 1,
                        data: hourlyData.map(item => item.responseTime),
                        smooth: true,
                        symbol: 'diamond',
                        symbolSize: 6,
                        lineStyle: {
                            width: 2,
                            type: 'dashed'
                        }
                    }
                ]
            };
            trendChart.setOption(trendOption);

            // 2. API Key Usage Distribution (水平条形图)
            const apiKeyChart = echarts.init(document.getElementById('apiKeyChart'), theme);
            const apiKeyOption = {
                tooltip: {
                    trigger: 'axis',
                    axisPointer: {
                        type: 'shadow'
                    },
                    backgroundColor: 'rgba(255, 255, 255, 0.95)',
                    borderColor: '#e2e8f0',
                    textStyle: {
                        color: '#0f172a',
                        fontSize: 12
                    }
                },
                grid: {
                    left: '15%',
                    right: '10%',
                    bottom: '10%',
                    top: '10%',
                    containLabel: true
                },
                xAxis: {
                    type: 'value',
                    axisLine: {
                        lineStyle: {
                            color: '#e2e8f0'
                        }
                    },
                    axisLabel: {
                        color: '#64748b',
                        fontSize: 12
                    },
                    splitLine: {
                        lineStyle: {
                            color: '#f1f5f9',
                            type: 'dashed'
                        }
                    }
                },
                yAxis: {
                    type: 'category',
                    data: ['Demo Key C', 'Demo Key B', 'Demo Key A'],
                    axisLine: {
                        lineStyle: {
                            color: '#e2e8f0'
                        }
                    },
                    axisLabel: {
                        color: '#64748b',
                        fontSize: 12
                    }
                },
                series: [{
                    name: 'Requests',
                    type: 'bar',
                    data: [1, 1, 1],
                    itemStyle: {
                        borderRadius: [0, 6, 6, 0],
                        color: new echarts.graphic.LinearGradient(0, 0, 1, 0, [
                            { offset: 0, color: '#3b82f6' },
                            { offset: 1, color: '#06b6d4' }
                        ])
                    },
                    emphasis: {
                        itemStyle: {
                            color: new echarts.graphic.LinearGradient(0, 0, 1, 0, [
                                { offset: 0, color: '#2563eb' },
                                { offset: 1, color: '#0891b2' }
                            ])
                        }
                    },
                    barWidth: '60%'
                }]
            };
            apiKeyChart.setOption(apiKeyOption);

            // 3. Operation Types Distribution (饼图)
            const operationChart = echarts.init(document.getElementById('operationChart'), theme);
            const operationOption = {
                tooltip: {
                    trigger: 'item',
                    formatter: '{a} <br/>{b}: {c} ({d}%)',
                    backgroundColor: 'rgba(255, 255, 255, 0.95)',
                    borderColor: '#e2e8f0',
                    textStyle: {
                        color: '#0f172a',
                        fontSize: 12
                    }
                },
                legend: {
                    bottom: 0,
                    textStyle: {
                        fontSize: 12
                    }
                },
                series: [{
                    name: 'Operations',
                    type: 'pie',
                    radius: ['40%', '70%'],
                    center: ['50%', '45%'],
                    avoidLabelOverlap: false,
                    label: {
                        show: false,
                        position: 'center'
                    },
                    emphasis: {
                        label: {
                            show: true,
                            fontSize: 14,
                            fontWeight: 'bold'
                        },
                        itemStyle: {
                            shadowBlur: 10,
                            shadowOffsetX: 0,
                            shadowColor: 'rgba(0, 0, 0, 0.5)'
                        }
                    },
                    labelLine: {
                        show: false
                    },
                    data: [
                        {
                            value: 2,
                            name: 'GET list',
                            itemStyle: {
                                color: new echarts.graphic.LinearGradient(0, 0, 1, 1, [
                                    { offset: 0, color: '#3b82f6' },
                                    { offset: 1, color: '#1d4ed8' }
                                ])
                            }
                        },
                        {
                            value: 1,
                            name: 'GET download',
                            itemStyle: {
                                color: new echarts.graphic.LinearGradient(0, 0, 1, 1, [
                                    { offset: 0, color: '#10b981' },
                                    { offset: 1, color: '#059669' }
                                ])
                            }
                        }
                    ]
                }]
            };
            operationChart.setOption(operationOption);

            // 4. Hourly Request Distribution (面积图)
            const hourlyChart = echarts.init(document.getElementById('hourlyChart'), theme);
            const hourlyOption = {
                tooltip: {
                    trigger: 'axis',
                    axisPointer: {
                        type: 'cross'
                    },
                    backgroundColor: 'rgba(255, 255, 255, 0.95)',
                    borderColor: '#e2e8f0',
                    textStyle: {
                        color: '#0f172a',
                        fontSize: 12
                    }
                },
                grid: {
                    left: '3%',
                    right: '4%',
                    bottom: '3%',
                    containLabel: true
                },
                xAxis: {
                    type: 'category',
                    boundaryGap: false,
                    data: hourlyData.map(item => item.time),
                    axisLine: {
                        lineStyle: {
                            color: '#e2e8f0'
                        }
                    },
                    axisLabel: {
                        color: '#64748b',
                        fontSize: 12
                    }
                },
                yAxis: {
                    type: 'value',
                    name: 'Requests',
                    axisLine: {
                        lineStyle: {
                            color: '#e2e8f0'
                        }
                    },
                    axisLabel: {
                        color: '#64748b',
                        fontSize: 12
                    },
                    splitLine: {
                        lineStyle: {
                            color: '#f1f5f9',
                            type: 'dashed'
                        }
                    }
                },
                series: [{
                    name: 'Requests',
                    type: 'line',
                    data: hourlyData.map(item => item.requests),
                    smooth: true,
                    symbol: 'circle',
                    symbolSize: 8,
                    lineStyle: {
                        width: 3,
                        color: '#3b82f6'
                    },
                    areaStyle: {
                        color: new echarts.graphic.LinearGradient(0, 0, 0, 1, [
                            { offset: 0, color: 'rgba(59, 130, 246, 0.3)' },
                            { offset: 1, color: 'rgba(59, 130, 246, 0.05)' }
                        ])
                    },
                    emphasis: {
                        focus: 'series',
                        itemStyle: {
                            shadowBlur: 10,
                            shadowColor: 'rgba(59, 130, 246, 0.5)'
                        }
                    }
                }]
            };
            hourlyChart.setOption(hourlyOption);

            // 响应式处理
            window.addEventListener('resize', function() {
                trendChart.resize();
                apiKeyChart.resize();
                operationChart.resize();
                hourlyChart.resize();
            });

            // 添加图表交互动画
            trendChart.on('highlight', function(params) {
                trendChart.dispatchAction({
                    type: 'showTip',
                    seriesIndex: params.seriesIndex,
                    dataIndex: params.dataIndex
                });
            });

            // 数据更新动画
            const updateCharts = () => {
                trendChart.setOption(trendOption, {notMerge: false, lazyUpdate: true});
                apiKeyChart.setOption(apiKeyOption, {notMerge: false, lazyUpdate: true});
                operationChart.setOption(operationOption, {notMerge: false, lazyUpdate: true});
                hourlyChart.setOption(hourlyOption, {notMerge: false, lazyUpdate: true});
            };

            return {
                trendChart,
                apiKeyChart,
                operationChart,
                hourlyChart,
                updateCharts
            };
        }

        // 导出数据功能
        function exportData() {
            const data = {
                timestamp: new Date().toISOString(),
                stats: {
                    totalRequests: 3,
                    activeUsers: 2,
                    successRate: 100.0,
                    errorRate: 0.0,
                    avgResponse: 13,
                    apiKeys: 3
                },
                hourlyData: hourlyData,
                apiKeyDistribution: [
                    { name: 'Demo Key A', requests: 1 },
                    { name: 'Demo Key B', requests: 1 },
                    { name: 'Demo Key C', requests: 1 }
                ],
                operationTypes: [
                    { name: 'GET list', value: 2 },
                    { name: 'GET download', value: 1 }
                ]
            };

            const blob = new Blob([JSON.stringify(data, null, 2)], {
                type: 'application/json'
            });

            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `analytics-dashboard-${new Date().toISOString().split('T')[0]}.json`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);

            // 显示导出成功提示
            showNotification('数据导出成功！', 'success');
        }

        // 显示通知
        function showNotification(message, type = 'info') {
            const notification = document.createElement('div');
            notification.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                padding: 12px 20px;
                border-radius: 8px;
                color: white;
                font-size: 14px;
                font-weight: 500;
                z-index: 10000;
                opacity: 0;
                transform: translateX(100px);
                transition: all 0.3s ease;
                box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            `;

            switch (type) {
                case 'success':
                    notification.style.backgroundColor = '#22c55e';
                    break;
                case 'error':
                    notification.style.backgroundColor = '#ef4444';
                    break;
                case 'warning':
                    notification.style.backgroundColor = '#f59e0b';
                    break;
                default:
                    notification.style.backgroundColor = '#3b82f6';
            }

            notification.textContent = message;
            document.body.appendChild(notification);

            // 动画显示
            setTimeout(() => {
                notification.style.opacity = '1';
                notification.style.transform = 'translateX(0)';
            }, 100);

            // 自动隐藏
            setTimeout(() => {
                notification.style.opacity = '0';
                notification.style.transform = 'translateX(100px)';
                setTimeout(() => {
                    document.body.removeChild(notification);
                }, 300);
            }, 3000);
        }

        // 筛选器变化处理
        function handleFilterChange() {
            const timeRange = document.getElementById('timeRange').value;
            const apiKey = document.getElementById('apiKey').value;
            const user = document.getElementById('user').value;

            // 模拟数据过滤
            console.log('Filters changed:', { timeRange, apiKey, user });

            // 这里可以添加实际的数据更新逻辑
            showNotification(`筛选器已更新: ${timeRange}`, 'info');
        }

        // 添加筛选器事件监听
        function initFilters() {
            document.getElementById('timeRange').addEventListener('change', handleFilterChange);
            document.getElementById('apiKey').addEventListener('change', handleFilterChange);
            document.getElementById('user').addEventListener('change', handleFilterChange);
        }

        // 加载状态处理
        function showLoading() {
            const containers = ['trendChart', 'apiKeyChart', 'operationChart', 'hourlyChart'];
            containers.forEach(id => {
                const container = document.getElementById(id);
                container.innerHTML = '<div class="loading"><i data-lucide="loader-2" class="icon" style="animation: spin 1s linear infinite; margin-right: 8px;"></i>Loading chart data...</div>';
            });
        }

        // 实时数据更新模拟
        function simulateRealTimeUpdates() {
            setInterval(() => {
                // 模拟新的数据点
                const currentTime = new Date();
                const timeStr = currentTime.toLocaleTimeString('en-US', {
                    hour12: false,
                    hour: '2-digit',
                    minute: '2-digit'
                });

                // 随机生成一些数据变化
                const randomRequests = Math.floor(Math.random() * 5);
                const randomResponseTime = Math.floor(Math.random() * 50) + 10;

                // 更新最后一个数据点
                if (hourlyData.length > 0) {
                    const lastIndex = hourlyData.length - 1;
                    hourlyData[lastIndex] = {
                        ...hourlyData[lastIndex],
                        requests: randomRequests,
                        success: randomRequests,
                        errors: 0,
                        responseTime: randomResponseTime
                    };
                }

                // 更新统计卡片
                updateStatsCards();
            }, 30000); // 每30秒更新一次
        }

        // 更新统计卡片
        function updateStatsCards() {
            const totalRequests = hourlyData.reduce((sum, item) => sum + item.requests, 0);

            // 更新总请求数
            const requestsCard = document.querySelector('.stat-card:nth-child(1) .stat-value');
            if (requestsCard) {
                requestsCard.textContent = totalRequests.toString();
            }

            // 添加脉冲动画效果
            const cards = document.querySelectorAll('.stat-card');
            cards.forEach(card => {
                card.style.transform = 'scale(1.02)';
                setTimeout(() => {
                    card.style.transform = 'scale(1)';
                }, 200);
            });
        }

        // 主题切换功能
        function toggleTheme() {
            const root = document.documentElement;
            const isDark = root.style.getPropertyValue('--background') === '#0f172a';

            if (isDark) {
                // 切换到亮色主题
                root.style.setProperty('--background', '#ffffff');
                root.style.setProperty('--foreground', '#0f172a');
                root.style.setProperty('--card', '#ffffff');
                root.style.setProperty('--muted-foreground', '#64748b');
            } else {
                // 切换到暗色主题
                root.style.setProperty('--background', '#0f172a');
                root.style.setProperty('--foreground', '#f8fafc');
                root.style.setProperty('--card', '#1e293b');
                root.style.setProperty('--muted-foreground', '#94a3b8');
            }

            // 重新初始化图表以应用新主题
            setTimeout(initCharts, 100);
        }

        // 键盘快捷键
        function initKeyboardShortcuts() {
            document.addEventListener('keydown', (e) => {
                // Ctrl/Cmd + E 导出数据
                if ((e.ctrlKey || e.metaKey) && e.key === 'e') {
                    e.preventDefault();
                    exportData();
                }

                // Ctrl/Cmd + T 切换主题
                if ((e.ctrlKey || e.metaKey) && e.key === 't') {
                    e.preventDefault();
                    toggleTheme();
                }

                // F5 刷新数据
                if (e.key === 'F5') {
                    e.preventDefault();
                    location.reload();
                }
            });
        }

        // 页面初始化
        let charts = null;

        document.addEventListener('DOMContentLoaded', function() {
            // 初始化 Lucide 图标
            if (typeof lucide !== 'undefined') {
                lucide.createIcons();
            }

            // 显示加载状态
            showLoading();

            // 延迟初始化图表以模拟加载
            setTimeout(() => {
                charts = initCharts();
                initFilters();
                initKeyboardShortcuts();

                // 重新创建图标（因为内容可能被更新）
                if (typeof lucide !== 'undefined') {
                    lucide.createIcons();
                }

                // 显示欢迎消息
                showNotification('Analytics Dashboard 加载完成！', 'success');

                // 启动实时更新（可选）
                // simulateRealTimeUpdates();
            }, 1000);
        });

        // 页面可见性API - 当页面变为可见时刷新图表
        document.addEventListener('visibilitychange', function() {
            if (!document.hidden && charts) {
                setTimeout(() => {
                    charts.trendChart.resize();
                    charts.apiKeyChart.resize();
                    charts.operationChart.resize();
                    charts.hourlyChart.resize();
                }, 100);
            }
        });

        // 错误处理
        window.addEventListener('error', function(e) {
            console.error('Dashboard error:', e.error);
            showNotification('发生错误，请刷新页面重试', 'error');
        });

        // 添加工具提示功能
        function initTooltips() {
            const statsCards = document.querySelectorAll('.stat-card');

            statsCards.forEach(card => {
                card.addEventListener('mouseenter', function() {
                    this.style.transform = 'translateY(-4px) scale(1.02)';
                    this.style.boxShadow = '0 12px 30px rgba(15, 23, 42, 0.2)';
                });

                card.addEventListener('mouseleave', function() {
                    this.style.transform = 'translateY(0) scale(1)';
                    this.style.boxShadow = '0 2px 8px rgba(15, 23, 42, 0.08)';
                });
            });
        }

        // 添加图表交互增强
        function enhanceChartInteractions() {
            if (!charts) return;

            // 为趋势图添加数据点点击事件
            charts.trendChart.on('click', function(params) {
                if (params.componentType === 'series') {
                    const dataInfo = {
                        time: params.name,
                        series: params.seriesName,
                        value: params.value
                    };

                    console.log('Chart data point clicked:', dataInfo);
                    showNotification(`${params.seriesName}: ${params.value} at ${params.name}`, 'info');
                }
            });

            // 为饼图添加片段点击事件
            charts.operationChart.on('click', function(params) {
                if (params.componentType === 'series') {
                    console.log('Pie chart segment clicked:', params.data);
                    showNotification(`${params.data.name}: ${params.data.value} requests`, 'info');
                }
            });
        }

        // 在图表初始化后添加交互增强
        setTimeout(() => {
            initTooltips();
            enhanceChartInteractions();
        }, 1500);
    </script>
</body>
</html>